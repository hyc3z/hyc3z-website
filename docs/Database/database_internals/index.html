<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Database/database_internals">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v0.0.0-5434">
<title data-rh="true">Database Basics | Hyc3z&#x27;s blog</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://hyc3z.github.io/docs/Database/database_internals"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Database Basics | Hyc3z&#x27;s blog"><meta data-rh="true" name="description" content="DBMS分类"><meta data-rh="true" property="og:description" content="DBMS分类"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://hyc3z.github.io/docs/Database/database_internals"><link data-rh="true" rel="alternate" href="https://hyc3z.github.io/docs/Database/database_internals" hreflang="en"><link data-rh="true" rel="alternate" href="https://hyc3z.github.io/docs/Database/database_internals" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Hyc3z&#39;s blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Hyc3z&#39;s blog Atom Feed">



<link rel="stylesheet" href="/katex/katex.min.css" crossorigin="anonymous">
<script src="/js/midiplayer.js"></script><link rel="stylesheet" href="/assets/css/styles.d3da1ba0.css">
<script src="/assets/js/runtime~main.bb8e8eaf.js" defer="defer"></script>
<script src="/assets/js/main.4c46d498.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Hyc3z&#x27;s blog</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Notes</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/hyc3z" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Hyc3z<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Artificial Intelligence</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Artificial Intelligence/artificial_intelligence_in_finance">Artificial Intelligence</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Artificial Intelligence/deep_learning">Deep Learning from Scratch</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Artificial Intelligence/interpretable_ai">Interpretable AI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Artificial Intelligence/on_the_opportunities_and_risks_of_foundation_models">On the Opportunities and Risks of Foundation Models - 2021</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Blockchain</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Blockchain/Chainlink">Chainlink</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Blockchain/Ethereum">Ethereum</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Blockchain/Polkadot">Polkadot</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Blockchain/Solidity">Solidity</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">C++</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/C++/pcal">C++</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Cryptography</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Cryptography/overview">Cryptography</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Data</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Data/data_science">Data Thoughts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Data/fighting_churn_with_data">Churn</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active">Database</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Database/Oracle">Oracle</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/Database/database_internals">Database Basics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Database/mongodb">MongoDB</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Design</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Design/ddd">Domain Driven Design</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Design/microservices">Microservices Patterns</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Design/software_architecture_fundamentals">Software Architecture</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Docker/">Docker</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Economics</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Economics/principles_of_economics">Principles of Economics</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Flutter/">Flutter Basics</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/Git/">Git Command</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Git/gitignore">Gitignore</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Graph</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Graph/graph-database">Graph Database Basics</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Kafka &amp; Spark</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Kafka &amp; Spark/hadoop">Hadoop 基础知识</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Kafka &amp; Spark/kafka">Kafka &amp; Zookeeper 基础知识</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Kafka &amp; Spark/spark">Spark 基础知识</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Math</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Math/category_theory">Category Theory</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Music</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Music/Practice">Practice</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Music/Theory">Theory</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Python</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Python/re">Regular Expression</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Typescript &amp; Javascript</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Typescript &amp; Javascript/eventloop">Event Loop</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Typescript &amp; Javascript/typescript">Developing</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Hello, World!</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Database</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Database Basics</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Database Basics</h1></header><h4 class="anchor anchorWithStickyNavbar_LWe7" id="dbms分类">DBMS分类<a href="#dbms分类" class="hash-link" title="Direct link to heading">​</a></h4><h5 class="anchor anchorWithStickyNavbar_LWe7" id="oltp-online-transaction-processing">OLTP Online Transaction Processing<a href="#oltp-online-transaction-processing" class="hash-link" title="Direct link to heading">​</a></h5><p>面向用户的请求和事务处理，Query是预先定好的</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="olap-online-analytical-processing">OLAP Online Analytical Processing<a href="#olap-online-analytical-processing" class="hash-link" title="Direct link to heading">​</a></h5><p>复杂聚合任务，分析、存储数据，运行复杂的query</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="htap-hybrid-transactional-and-analytical-processing">HTAP Hybrid transactional and analytical processing<a href="#htap-hybrid-transactional-and-analytical-processing" class="hash-link" title="Direct link to heading">​</a></h5><p>混合了OLAP和OLTP的特性</p><p><img loading="lazy" alt="dbin 0101" src="/assets/images/dbin_0101-37a1b1b725536ff01d7d39ea1509cd11.png" width="1182" height="1880" class="img_ev3q"></p><p>Query -&gt; Execution plan -&gt; Execution engine -&gt; Storage engine</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="storage-engine">Storage Engine<a href="#storage-engine" class="hash-link" title="Direct link to heading">​</a></h4><h5 class="anchor anchorWithStickyNavbar_LWe7" id="transaction-manager">Transaction Manager<a href="#transaction-manager" class="hash-link" title="Direct link to heading">​</a></h5><p>管理事务，事务只有在确保一致性的情况下才能离开数据库</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="lock-manager">Lock Manager<a href="#lock-manager" class="hash-link" title="Direct link to heading">​</a></h5><p>负责给数据库对象加锁，保证数据完整性</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="access-methodsstorage-structures">Access Methods(storage structures)<a href="#access-methodsstorage-structures" class="hash-link" title="Direct link to heading">​</a></h5><p>数据在磁盘上的存取，B-Tree LSM Tree</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="buffer-manager">Buffer Manager<a href="#buffer-manager" class="hash-link" title="Direct link to heading">​</a></h5><p>在内存中缓存数据</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="recovery-manager">Recovery Manager<a href="#recovery-manager" class="hash-link" title="Direct link to heading">​</a></h5><p>存储操作日志，在出错时恢复系统状态</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="memory-based-stores">Memory-Based Stores<a href="#memory-based-stores" class="hash-link" title="Direct link to heading">​</a></h5><p>速度快，但内存价格贵，且易失</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="disk-based-database">Disk-Based Database<a href="#disk-based-database" class="hash-link" title="Direct link to heading">​</a></h5><p>磁盘的随机存取比内存随机存取慢得多，因此磁盘存储结构通常都是树结构，内存数据库数据结构则更加多样。</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="column---vs-row--oriented-dbms">Column - vs Row- Oriented DBMS<a href="#column---vs-row--oriented-dbms" class="hash-link" title="Direct link to heading">​</a></h5><p>通常数据库都存着数据记录的集合，包括行、列以及它们的交点——Field。</p><p><img loading="lazy" alt="dbin 0102" src="/assets/images/dbin_0102-728f00e7a6fa55c085b777ae55603558.png" width="2817" height="639" class="img_ev3q"></p><p>行存储的数据库很多，比如MySQL，Postgres</p><p>列存储如MonetDB C-Store，Apache Druid</p><p>在存储上，行存储在聚合查询时，会把不必要的列也拿出来，增加开销。列存储则更适合聚合，同一种数据类型存储在一起也会最大化压缩效率（对不同类型选择不同压缩算法）。</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="wide-column-store">Wide Column Store<a href="#wide-column-store" class="hash-link" title="Direct link to heading">​</a></h5><p>如 BigTable 和HBase</p><p>不要和Column oriented混淆了。</p><p>Wide Column Store其实是对columns进行分组，每个分组内部还是row-wise store.</p><p><img loading="lazy" alt="dbin 0104" src="/assets/images/dbin_0104-422e8b43a62b9717860388b6551f04a2.png" width="1439" height="604" class="img_ev3q"></p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="data-files-and-index-files">Data files and Index files<a href="#data-files-and-index-files" class="hash-link" title="Direct link to heading">​</a></h5><p>data files存储records，index files存储meta数据</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="data-files">Data files<a href="#data-files" class="hash-link" title="Direct link to heading">​</a></h5><p>多种形式，如</p><p>Index Organized Tables</p><p>Heap Organized Tables</p><p>Hash Organized Tables</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="index-file">Index file<a href="#index-file" class="hash-link" title="Direct link to heading">​</a></h5><p>在Primary data file上的index就称作Primary Index。</p><p>Secondary index可以直接指向数据record，也可以只存Primary key。</p><p>Clustered and Nonclustered：有序和无序</p><p><img loading="lazy" alt="dbin 0105" src="/assets/images/dbin_0105-bc75954874128bba1c892090502be790.png" width="5700" height="1470" class="img_ev3q"></p><p>在数据表没有指定primary key时，数据库会默认创建一列主键</p><p>如果Index直接指向数据，在读取时确实减少了读盘次数，但更新时需要直接更新指针，对于Write heavy的应用来说，开销是非常大的。而Mysql InnoDB使用了两次查找的方式，Secondary Index和Primary Index。</p><p><img loading="lazy" alt="dbin 0106" src="/assets/images/dbin_0106-a732429f9e02c9448b0008a1d172b264.png" width="2991" height="1176" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="b-tree">B-Tree<a href="#b-tree" class="hash-link" title="Direct link to heading">​</a></h4><p>introduced by Rudolph Bayer and Edward M. McCreight back in 1971</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="binary-search-treesbst">Binary Search Trees(BST)<a href="#binary-search-treesbst" class="hash-link" title="Direct link to heading">​</a></h5><p><img loading="lazy" alt="dbin 0202" src="/assets/images/dbin_0202-b237d34970a8b9e60a7ece0649b2e0ea.png" width="608" height="434" class="img_ev3q"></p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="tree-balancing">Tree Balancing<a href="#tree-balancing" class="hash-link" title="Direct link to heading">​</a></h5><p><img loading="lazy" alt="dbin 0203" src="/assets/images/dbin_0203-1f964eab01828da3375e219fe1e03925.png" width="1441" height="538" class="img_ev3q"></p><p>平衡 vs 不平衡 树</p><p>如果树退化了，查找复杂度就不再是Log~2~N而是N了。</p><p>二叉树旋转，中间的节点作为轴，旋转成为新的父节点</p><p><img loading="lazy" alt="dbin 0204" src="/assets/images/dbin_0204-750f737696b29101629496872e4b8829.png" width="847" height="360" class="img_ev3q"></p><p>然而，BST有几个问题：</p><p>首先，每次插入都需要做平衡操作，读写开销都很大。</p><p>其次，父节点不一定存在子节点附近，如果相差很远，就需要到别的扇区读取，增加寻道时间。</p><p>所以，需要两点改进：</p><p>1、增加子节点数量，不再是2个</p><p>2、降低树的高度，减少seek次数</p><p><img loading="lazy" alt="dbin 0207" src="/assets/images/dbin_0207-99008f11b13f62f14a876439dd1e044c.png" width="2817" height="468" class="img_ev3q"></p><p><img loading="lazy" alt="dbin 0209" src="/assets/images/dbin_0209-8611a4b83ce9e3f04861fd6f53b096a4.png" width="4014" height="1128" class="img_ev3q"></p><p>B-Tree在任何层级都可以存储数据，而B+-Tree只在叶节点存数据。</p><p>InnoDB将B+-Tree实现也称为B-Tree</p><p>B-Tree 的构建是从Bottom to top，不像BST是从Top to bottom</p><p><img loading="lazy" alt="dbin 0210" src="/assets/images/dbin_0210-bd313d6a54d73011abaa03e269d74aec.png" width="1440" height="465" class="img_ev3q"></p><p>有些B-Tree叶节点也会包含指向兄弟节点的指针，有些是双向指针，使得最底层的叶节点也称为一个双向链表。</p><p>当节点插入的数据超过一个阈值，就会触发分裂。</p><p>当相邻节点的数据量低于N，就可以触发合并。</p><p>我们希望B-Tree也能存储在硬盘上，但是内存里的数据存储形式不是很关键，因为内存的随机存取速度很快。在硬盘上，我们就需要考虑垃圾回收，碎片整理等情况。</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="big-little-endian">Big Little Endian<a href="#big-little-endian" class="hash-link" title="Direct link to heading">​</a></h5><p><img loading="lazy" alt="dbin 0301" src="/assets/images/dbin_0301-d1c8039931b15a0169724b99908a34e6.png" width="1441" height="182" class="img_ev3q"></p><p>文件结构</p><p><img loading="lazy" alt="dbin 0303" src="/assets/images/dbin_0303-5c5b241b533d2eb52f37b9d0200a096b.png" width="1439" height="385" class="img_ev3q"></p><p>Header和Trailer都包含一些辅助信息，用于解密数据等</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="simple-page-organization">Simple Page Organization<a href="#simple-page-organization" class="hash-link" title="Direct link to heading">​</a></h5><p><img loading="lazy" alt="dbin 0304" src="/assets/images/dbin_0304-d01fd3c4874813d08100c042bf9a8f1b.png" width="1439" height="126" class="img_ev3q"></p><p>有一些问题：</p><p>增加Key就涉及到移动元素</p><p>只适合固定长度的数据，不能够存取变长数据</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="slotted-pages">Slotted Pages<a href="#slotted-pages" class="hash-link" title="Direct link to heading">​</a></h5><p><img loading="lazy" alt="dbin 0305" src="/assets/images/dbin_0305-09721a0777d45465519889aff39caba9.png" width="906" height="704" class="img_ev3q"></p><p>在每一个Page中，有一个Page header,包含Page和Cell的信息。然后Cell里面存储了一些数据，可以是任意数据。Pointers指向cell。</p><p>Cell的好处在于，在删除的时候只需要指针置空就好了，然后数据长度也是不固定的。碎片和不连续空间只需要重新写一遍Page就可以得到处理。</p><p>而且，如果需要排序，只需要对Pointer排序就可以，不需要对实际数据进行重新排序。</p><p><img loading="lazy" alt="dbin 0309" src="/assets/images/dbin_0309-79078a70b2fed851d9988b57d7c434ac.png" width="1441" height="435" class="img_ev3q"></p><p>所有的空闲区域组成一个Availability List。SQLite会存储指向第一个空闲块的指针。</p><p>新的数据插入，会遵循两种:</p><p>First Fit或者Best Fit，来尝试插入。</p><p>如果defragmentation之后，还是无法插入，就需要创建Overflow Page。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="page-header">Page Header<a href="#page-header" class="hash-link" title="Direct link to heading">​</a></h4><h5 class="anchor anchorWithStickyNavbar_LWe7" id="magic-numbers">Magic Numbers<a href="#magic-numbers" class="hash-link" title="Direct link to heading">​</a></h5><p>代表page的id，类型或者版本。</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="sibling-links">Sibling Links<a href="#sibling-links" class="hash-link" title="Direct link to heading">​</a></h5><p>不必再去访问父节点来得到兄弟节点的信息</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="rightmost-pointers">Rightmost Pointers<a href="#rightmost-pointers" class="hash-link" title="Direct link to heading">​</a></h5><p><img loading="lazy" alt="dbin 0402" src="/assets/images/dbin_0402-d74a04e406bbb7c940333fb033c522bf.png" width="1440" height="465" class="img_ev3q"></p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="node-high-keys">Node High Keys<a href="#node-high-keys" class="hash-link" title="Direct link to heading">​</a></h5><p><img loading="lazy" alt="dbin 0405" src="/assets/images/dbin_0405-9bbd290a1b5bc08f7b181582156b6c72.png" width="1440" height="428" class="img_ev3q"></p><p>指针可以成对出现，直接指向叶节点，代表叶节点的最值</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="overflow-page">Overflow Page<a href="#overflow-page" class="hash-link" title="Direct link to heading">​</a></h5><p><img loading="lazy" alt="dbin 0406" src="/assets/images/dbin_0406-bedd63b1462fe046de2a6a91fc37b99a.png" width="802" height="918" class="img_ev3q"></p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="breadcrumbs">Breadcrumbs<a href="#breadcrumbs" class="hash-link" title="Direct link to heading">​</a></h5><p><img loading="lazy" alt="dbin 0408" src="/assets/images/dbin_0408-5fe1bf37661ea088c5e12c91610a98dc.png" width="1440" height="1327" class="img_ev3q"></p><p>Header中存上遍历到这个节点的路径经过的节点，用于链式合并、分解节点</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="right-only-appends">Right-Only Appends<a href="#right-only-appends" class="hash-link" title="Direct link to heading">​</a></h5><p>如果添加的数据比最右Page的值还大，那么就可以省略查找路径的过程，直接在最右节点增加数据(Postgres)或者创建一个新的最右节点(SQLite)，然后添加到父节点。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="acid">ACID<a href="#acid" class="hash-link" title="Direct link to heading">​</a></h4><p>Atomicity 事务步骤是不可分割的，所有步骤成功或者都不成功。</p><p>Consistency 让数据库从一个有效状态更新到另一个有效状态，应用层</p><p>Isolation 多个并发事务应当互相不干扰。</p><p>Durability 所有更改应当能够持久化到磁盘</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="cache-eviction">Cache Eviction<a href="#cache-eviction" class="hash-link" title="Direct link to heading">​</a></h5><p>当Cache中的page被修改过后，它会被置脏。因此，在evict脏page时，需要先flush到磁盘，再evict。</p><p>如果每一次eviction都做flush显然开销太大，PostgreSQL有一个后台进程定时去执行任务。</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="pinned-pages">Pinned Pages<a href="#pinned-pages" class="hash-link" title="Direct link to heading">​</a></h5><p>由于B-Tree的特性，最上层的节点几乎总是被访问到，因此将它们持久缓存是收益很大的。</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="page-replacement">Page Replacement<a href="#page-replacement" class="hash-link" title="Direct link to heading">​</a></h5><p>FIFO LRU Clock</p><p>Clock</p><p><img loading="lazy" alt="dbin 0502" src="/assets/images/dbin_0502-76128854194f2b785fe5dd95e20f1640.png" width="1438" height="1438" class="img_ev3q"></p><p>如果指针指向的Page目前没有被访问(灰色的正在被引用，白色不在被引用)，将它的访问bit 置为0.如果已经是0，那么准备eviction。</p><p>LFU Least Frequently Used</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="recovery">Recovery<a href="#recovery" class="hash-link" title="Direct link to heading">​</a></h4><p><em>write-ahead log</em> (commit log) 只追加，不可修改</p><p>每一条record 都有一个log sequence number(LSN)</p><p>所有数据库的写操作都要事先Log,然后才能修改Page</p><p>Page Cache能够重建</p><p>Log Checkpoint，标记到N开始的log已经被持久化，不再需要了。</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="steal-and-force">Steal and force<a href="#steal-and-force" class="hash-link" title="Direct link to heading">​</a></h5><p>Steal：允许还未完成事务的page flush到磁盘上。</p><p>Force： 在事务commit之前，所有修改的Page必须被flush到磁盘上</p><p>如果设置了no-steal，那么只需要redo log就可以恢复数据库</p><p>设置了force，transaction会慢的多，但重建就相对简单。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="concurrency-control">Concurrency Control<a href="#concurrency-control" class="hash-link" title="Direct link to heading">​</a></h4><p>Optimistic concurrency control </p><p>如果多个事务的执行结果有分歧，其中的一个会被丢弃。所有事务都被允许并发读写，然后判断结果</p><p>Multiversion concurrency</p><p>timestamp顺序，允许多个时间点的版本共存。</p><p>Pessimistic concurrency control</p><p>lock-based: 防止其他事务修改加锁的纪录</p><p>Nonlocking: 维护一个列表，顺序执行</p><p>可能出现死锁问题</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="serializable-schedule">Serializable schedule<a href="#serializable-schedule" class="hash-link" title="Direct link to heading">​</a></h5><p><img loading="lazy" alt="dbin 0504" src="/assets/images/dbin_0504-196d53a3115d645c2dd87f396c672340.png" width="1438" height="450" class="img_ev3q"></p><p>多个transaction按任意顺序执行，one by one</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="isolation-levels">Isolation Levels<a href="#isolation-levels" class="hash-link" title="Direct link to heading">​</a></h5><p>最低级别的isolation是read uncommitted，允许transaction读取dirty reads</p><p><img loading="lazy" alt="dbin 0505" src="/assets/images/dbin_0505-948ca50cf6b1b453531b3db4dd63a9c1.png" width="1439" height="300" class="img_ev3q"></p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="optimistic-concurrency-control">Optimistic Concurrency Control<a href="#optimistic-concurrency-control" class="hash-link" title="Direct link to heading">​</a></h5><p>假设事务冲突很少，我们不需要加锁，只需要验证事务的合法性来判断是否commit。</p><p>事务被分为三步：</p><p>Read, Validation, Write</p><p>Backward-oriented 检查与已经commit的事务是否冲突</p><p>Forward-oriented 检查正在进行validation的事务是否冲突</p><p>只要有其他事务正在被validate，现在的事务就不允许commit。</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="multiversion-concurrency-control">Multiversion Concurrency Control<a href="#multiversion-concurrency-control" class="hash-link" title="Direct link to heading">​</a></h5><p>区分committed 和uncomitted的版本，对应committed和uncommitted的事务。</p><p>最后一个committed的版本就是current。</p><p>通常来说，目标就是至多有一个uncommitted值。</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="pessimistic-concurrency-control">Pessimistic Concurrency Control<a href="#pessimistic-concurrency-control" class="hash-link" title="Direct link to heading">​</a></h5><p>time-stamp ordering：如果时间戳更晚的事务已经提交，当前事务就只能取消</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="lock-based-concurrency-control">Lock-Based Concurrency Control<a href="#lock-based-concurrency-control" class="hash-link" title="Direct link to heading">​</a></h5><p>Two-phase locking(2PL)</p><p>Growing phase: 取得所有需要的锁</p><p>Shrinking phase：释放所有取得的锁</p><p>解决死锁：</p><p>追踪依赖图是否有环</p><p>超时、裁定优先级</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="locks-and-latches">Locks and Latches<a href="#locks-and-latches" class="hash-link" title="Direct link to heading">​</a></h5><p>Locks：逻辑数据一致性, content</p><p>Latch: 物理数据一致性， page level</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="rw-lock">RW Lock<a href="#rw-lock" class="hash-link" title="Direct link to heading">​</a></h5><p><img loading="lazy" alt="dbin 0507" src="/assets/images/dbin_0507-7173061759e5e3becca4b66bbed9e7fc.png" width="1261" height="359" class="img_ev3q"></p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="copy-on-write">Copy-on-write<a href="#copy-on-write" class="hash-link" title="Direct link to heading">​</a></h5><p>当数据即将被修改时，创建一个备份，然后修改备份。</p><p>这样Reader读到的还是原本，不需要同步。</p><p>缺点就是占用空间较大</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="lazy-b-tree">Lazy B-Tree<a href="#lazy-b-tree" class="hash-link" title="Direct link to heading">​</a></h5><p><img loading="lazy" alt="dbin 0602" src="/assets/images/dbin_0602-b64654b6992647612351a4589a2b2eb4.png" width="2673" height="882" class="img_ev3q"></p><p>读写都会在缓存中进行，然后定期flush到树中持久化</p><p>由于split 和merge转到后台运行，r/w操作不需要等待。</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="lazy-adaptive-tree">Lazy Adaptive Tree<a href="#lazy-adaptive-tree" class="hash-link" title="Direct link to heading">​</a></h5><p>每个node都有一个buffer，当根节点buffer满了，就会写到子树的buffer，一直推到叶节点。</p><p><img loading="lazy" alt="dbin 0604" src="/assets/images/dbin_0604-5ea39eb67bd6d3f5cbbc3d0853631b39.png" width="4137" height="1851" class="img_ev3q"></p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="fd-tree">FD-Tree<a href="#fd-tree" class="hash-link" title="Direct link to heading">​</a></h5><p>假设有下列几个数组：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">A1 = [12, 24, 32, 34, 39]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">A2 = [22, 25, 28, 30, 35]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">A3 = [11, 16, 24, 26, 30]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>每个数组都向下方的数组抽元素，填充到自己的元素中</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">A1 = [12, 24, 25, 30, 32, 34, 39]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">A2 = [16, 22, 25, 26, 28, 30, 35]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">A3 = [11, 16, 24, 26, 30]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="dbin 0605" src="/assets/images/dbin_0605-ebaab3c57c835312e5cc952f3ec0e59a.png" width="1080" height="780" class="img_ev3q"></p><p>这种连接方式被称为Bridge，可以大大缩小查找空间。</p><p><img loading="lazy" alt="dbin 0606" src="/assets/images/dbin_0606-c1bf7860be20534985119fac842940dd.png" width="6627" height="1332" class="img_ev3q"></p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="bw-tree">Bw-Tree<a href="#bw-tree" class="hash-link" title="Direct link to heading">​</a></h5><p><img loading="lazy" alt="dbin 0607" src="/assets/images/dbin_0607-0e403e4ee43aca6019418cf11f8c85a6.png" width="3345" height="681" class="img_ev3q"></p><p>Update chain包含修改信息，Base node不做in place 修改</p><p>这样如果要更换事务顺序，只需要compare and swap，更换Update chain里的pointer就可以了。</p><p>Update chain在达到阈值后，就需要merge base node with deltas，写到新的page上然后改变父节点的指针。</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="lsm-tree">LSM-Tree<a href="#lsm-tree" class="hash-link" title="Direct link to heading">​</a></h5><p>Append-only </p><p>因此insert update delete不需要定位到磁盘上的record，显著提升写性能和吞吐量。</p><p>允许重复数据，冲突在读时解决</p><p>LSM Tree在写比读更多时很常用</p><p>简而言之，In-place update对读更友好，写则需要定位到位置。</p><p>Append-only对写更友好，但读取时需要取到多个版本的数据然后整合。</p><p>B-Tree也经常作为LSM Tree的索引结构</p><p>LSM树将数据的写缓存到内存里的表结构中。读和写分离，所以读写可以同时进行。</p><p>当LSM树接收到写请求后，存到mutable memtable中，buffer and sort。达到一定阈值后，持久化到磁盘。</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="two-and-multi-component-lsm-trees">Two and Multi component LSM Trees<a href="#two-and-multi-component-lsm-trees" class="hash-link" title="Direct link to heading">​</a></h5><p>Two component只有一个磁盘树。对每个内存中的子树，都和磁盘中对应的子树合并，生成一个新的子树写到新的磁盘区域。当子树被flush之后，之前的树就被丢弃了，取而代之的是新的树。</p><p><a href="https://kernelmaker.github.io/lsm-tree" target="_blank" rel="noopener noreferrer">【Paper笔记】The Log structured Merge-Tree（LSM-Tree） · (kernelmaker.github.io)</a></p><p>Multicomponent </p><p><img loading="lazy" alt="dbin 0703" src="/assets/images/dbin_0703-770dd5396041a8ae92b3bc62ee9c96af.png" width="1440" height="354" class="img_ev3q"></p><p><img loading="lazy" alt="dbin 0704" src="/assets/images/dbin_0704-25746020c13b095465b16273776dd69d.png" width="1440" height="599" class="img_ev3q"></p><p>在LSM中，Update和Insert是无法区分的，因此可以称作Upsert</p><p>Compaction</p><p>根据树的层级进行整合</p><p><img loading="lazy" alt="dbin 0706" src="/assets/images/dbin_0706-7ad2540683188832bd35f12e43f6c513.png" width="2643" height="735" class="img_ev3q"></p><p>LSM的disk-resident table是SSTable( Sorted String Table)，一般包含一个index file和 data file，index file可以使用B-Tree或哈希表。</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="bloom-filter">Bloom Filter<a href="#bloom-filter" class="hash-link" title="Direct link to heading">​</a></h5><p>使用一个大型的bit array，多个哈希函数。</p><p>对每个record的键进行哈希操作，把得到结果作为下标的位置为1。</p><p>如果给定一个key，所有哈希函数对它求哈希值后对应的位都是1，那么它<strong>很有可能</strong>在这个集合中，否则只要有1个出现0，那么它<strong>一定</strong>不在集合中。</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="skiplist">Skiplist<a href="#skiplist" class="hash-link" title="Direct link to heading">​</a></h5><p><img loading="lazy" alt="dbin 0708" src="/assets/images/dbin_0708-6f10cb239f9f5c1bc9c61ab87cf5a062.png" width="1441" height="185" class="img_ev3q"></p><p>每个节点的高度都是随机的。</p><p>假如从10出发，找7。</p><p>1、10&gt;7，回退到下一层的上一个节点</p><p>2、到达5，5&lt;7，前进，又回到10，还是比7大，回退下一层的上一个节点</p><p>3、到达7</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="keydir">Keydir<a href="#keydir" class="hash-link" title="Direct link to heading">​</a></h5><p><img loading="lazy" alt="dbin 0711" src="/assets/images/dbin_0711-8459c651f8dbb47fba77d26cea4736f7.png" width="1439" height="855" class="img_ev3q"></p><p><img loading="lazy" alt="dbin 0001" src="/assets/images/dbin_0001-06eebc7e8fa027ef72f318e2859990e9.png" width="1441" height="997" class="img_ev3q"></p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/Database/Oracle"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Oracle</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/Database/mongodb"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">MongoDB</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"></div></div></div></div></main></div></div></div></div>
</body>
</html>